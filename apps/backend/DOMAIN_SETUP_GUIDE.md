# ???? ???????? ?????? ?????????? ?????? ???????????????? ????????????????

## ???? **??????????????:**

### **1?????? ?????????? ?????????? ?????? ?????? ????????????????:**

#### **??) ?????????????? ngrok (???????? ?????????? - ??????????????):**

```bash
# ?????????? ngrok
npm install -g ngrok

# ?????????? ngrok
ngrok http 5000

# ?????????? ?????? ???????? ??????:
# https://abc123.ngrok.io
```

**????????????????:**
- ??? ?????? ????????
- ??? HTTPS ????????????
- ??? ?????????? ??????????????
- ??? ???????????? ?????????? ???? ?????? (???? ?????? ???????????? ????????????????)

---

#### **??) ?????????????? Cloudflare Tunnel (?????????? + ????????):**

```bash
# ?????????? cloudflared
# Windows: ?????????? ???? cloudflare.com
# ???? ?????????????? Chocolatey: choco install cloudflared

# ?????????? ????????????
cloudflared tunnel login

# ?????????? tunnel
cloudflared tunnel create rare4n-backend

# ?????????? DNS
cloudflared tunnel route dns rare4n-backend api.rare4n.com

# ?????????? tunnel
cloudflared tunnel run rare4n-backend
```

**????????????????:**
- ??? ?????????? 100%
- ??? ?????????? ????????
- ??? HTTPS ????????????
- ??? ???????? ????????

---

#### **??) ?????????????? VPS + Nginx (??????????????):**

```bash
# ?????? VPS:
# 1. ?????????? Nginx
sudo apt install nginx

# 2. ?????????? reverse proxy
sudo nano /etc/nginx/sites-available/rare4n-backend

# 3. ??????????????:
server {
    listen 80;
    server_name api.rare4n.com;

    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}

# 4. ?????????? SSL ???? Let's Encrypt
sudo certbot --nginx -d api.rare4n.com
```

---

### **2?????? ?????????? ?????????? ?????? (?????? + ??????):**

#### **??) ?????????? Security Headers:**
```javascript
// ??? ???? server.js
app.use((req, res, next) => {
  res.setHeader('X-Content-Type-Options', 'nosniff');
  res.setHeader('X-Frame-Options', 'DENY');
  res.setHeader('X-XSS-Protection', '1; mode=block');
  res.setHeader('Strict-Transport-Security', 'max-age=31536000');
  next();
});
```

#### **??) ?????????? Rate Limiting:**
```javascript
// ??? ??????????: npm install express-rate-limit
import rateLimit from 'express-rate-limit';

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 ??????????
  max: 100, // 100 ?????? ?????? IP
});

app.use('/api/', limiter);
```

#### **??) ?????????? Compression:**
```javascript
// ??? ??????????: npm install compression
import compression from 'compression';

app.use(compression());
```

#### **??) ?????????? CORS:**
```javascript
// ??? CORS ??????????
app.use(cors({
  origin: [
    'http://localhost:8081', // Expo Dev
    'https://api.rare4n.com', // Production
    'https://*.ngrok.io', // ngrok
  ],
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],
  allowedHeaders: ['Content-Type', 'Authorization', 'X-User-ID'],
}));
```

---

### **3?????? ?????????? Mobile App:**

#### **??) ?????????? Config File:**
```typescript
// mobile/config/api.ts
const isDev = __DEV__;
const isProduction = !isDev;

// Development
const DEV_API = 'http://192.168.1.X:5000/api'; // IP address ??????????????

// Production
const PROD_API = 'https://api.rare4n.com/api'; // ??????????????

// ngrok (??????????????)
const NGROK_API = 'https://abc123.ngrok.io/api';

export const API_BASE = isProduction ? PROD_API : NGROK_API;
```

#### **??) ?????????????? Config ???? ???????? ??????????????:**
```typescript
// ??? ???? boot.tsx, login.tsx, home.tsx, etc.
import { API_BASE } from '../config/api';

// ?????????? ????:
// const API_BASE = 'http://localhost:5000/api';
```

---

### **4?????? ?????????????? ???????????? ??????????:**

#### **??) Database Connection Pooling:**
```javascript
// ??? ???? localDB.js
// SQLite ???? ?????????? pooling?? ?????? ???????? ????????????:
const db = new Database(DB_PATH, {
  verbose: console.log, // ?????????????? ??????
  timeout: 5000,
});
```

#### **??) Error Handling ????????:**
```javascript
// ??? ???? server.js
app.use((err, req, res, next) => {
  console.error('Error:', err);
  res.status(500).json({
    success: false,
    error: 'Internal server error',
    message: process.env.NODE_ENV === 'development' ? err.message : undefined,
  });
});
```

#### **??) Request Logging:**
```javascript
// ??? ??????????: npm install morgan
import morgan from 'morgan';

app.use(morgan('combined'));
```

#### **??) Health Check ??????????:**
```javascript
// ??? ???? server.js
app.get('/health', (req, res) => {
  res.json({
    status: 'online',
    database: db ? 'connected' : 'disconnected',
    uptime: process.uptime(),
    memory: process.memoryUsage(),
    timestamp: new Date().toISOString(),
  });
});
```

---

## ???? **?????????????? ??????????????:**

### **?????????????? ???????????? (ngrok):**

1. **?????????? ?????????? ??????:**
   ```bash
   cd backend
   npm start
   ```

2. **?????????? ngrok:**
   ```bash
   ngrok http 5000
   ```

3. **?????? ???????????? (??????: https://abc123.ngrok.io)**

4. **?????????? mobile/config/api.ts:**
   ```typescript
   export const API_BASE = 'https://abc123.ngrok.io/api';
   ```

5. **?????????? ?????????? ??????????????**

---

### **?????????????? ???????????????????? (Cloudflare Tunnel):**

1. **?????????? cloudflared:**
   ```bash
   # Windows: ?????????? ???? cloudflare.com
   ```

2. **?????????? ????????????:**
   ```bash
   cloudflared tunnel login
   ```

3. **?????????? tunnel:**
   ```bash
   cloudflared tunnel create rare4n-backend
   ```

4. **?????????? DNS:**
   ```bash
   cloudflared tunnel route dns rare4n-backend api.rare4n.com
   ```

5. **?????????? tunnel:**
   ```bash
   cloudflared tunnel run rare4n-backend
   ```

6. **?????????? mobile/config/api.ts:**
   ```typescript
   export const API_BASE = 'https://api.rare4n.com/api';
   ```

---

## ???? **???????????? ??????????:**

| ?????????????? | ?????????????? | ?????????????? | ???????????? | ???????????? |
|---------|---------|---------|--------|--------|
| ngrok | ??????????????? | ??????????/?????????? | ??? | ??? |
| Cloudflare Tunnel | ???????????? | ?????????? | ??? | ?????? |
| VPS + Nginx | ?????? | ?????????? | ??? | ????????? |

---

## ??? **??????????????:**

**?????????????? ????????????:** ???????????? ngrok
**??????????????:** ???????????? Cloudflare Tunnel ???? VPS + Nginx

**?????????? ?????? ?????????? ??????????:**
- ??? Security Headers
- ??? Rate Limiting
- ??? Compression
- ??? Error Handling
- ??? Logging
- ??? Health Checks
- ??? CORS ??????????










