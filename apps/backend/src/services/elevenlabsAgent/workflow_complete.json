{
  "agent_id": "agent_0701kc4axybpf6fvak70xwfzpyka",
  "name": "RARE 4N Customer Service Workflow",
  "description": "Workflow ???????? ?????????????? ???? ?????????????? ???? ?????????????? ??????????????",
  "nodes": [
    {
      "id": "start",
      "type": "start",
      "label": "Start",
      "position": { "x": 100, "y": 100 },
      "data": {
        "message_ar": "????????????! ???? ?????????? ???? ???? RARE 4N. ?????? ???????????? ??????????.",
        "message_en": "Hello! ???? Welcome to RARE 4N. I'm your smart assistant."
      }
    },
    {
      "id": "rare_greeting",
      "type": "message",
      "label": "RARE 4N",
      "position": { "x": 100, "y": 200 },
      "data": {
        "message_ar": "????????????! ???? ?????????? ???? ???? RARE 4N.\n\n???????????? ?????????????? ????:\n???? ???????? ??????????\n??????? ???????? ????????\n???? ???????????? ??????\n???? ???????????? ??????????\n???? ???????????? ??????????????\n\n?????? ???????????? ?????????????? ????????????",
        "message_en": "Hello! ???? Welcome to RARE 4N.\n\nI can help you with:\n???? Building an app\n??????? Building a system\n???? Choosing a theme\n???? Processing payment\n???? Tracking orders\n\nHow can I help you today?",
        "wait_for_response": true
      }
    },
    {
      "id": "detect_intent",
      "type": "condition",
      "label": "Detect Intent",
      "position": { "x": 100, "y": 300 },
      "data": {
        "conditions": [
          {
            "condition": "contains",
            "keywords_ar": ["??????????", "app", "????????????"],
            "keywords_en": ["app", "application", "software"],
            "next_node": "show_apps"
          },
          {
            "condition": "contains",
            "keywords_ar": ["????????", "system"],
            "keywords_en": ["system", "platform"],
            "next_node": "show_systems"
          },
          {
            "condition": "contains",
            "keywords_ar": ["??????", "theme", "??????????"],
            "keywords_en": ["theme", "design", "template"],
            "next_node": "show_themes"
          },
          {
            "condition": "contains",
            "keywords_ar": ["??????", "order", "????????????"],
            "keywords_en": ["order", "track", "status"],
            "next_node": "check_order"
          },
          {
            "condition": "default",
            "next_node": "ask_type"
          }
        ]
      }
    },
    {
      "id": "ask_type",
      "type": "message",
      "label": "Ask Type",
      "position": { "x": 100, "y": 400 },
      "data": {
        "message_ar": "???? ?????? ?????????????? ???????? ????????????\n\n1?????? ?????????? (App)\n2?????? ???????? (System)\n3?????? ?????? (Theme)\n\n???????? ???????????? ?????? ???? ?????????? ??????????.",
        "message_en": "What type of project do you want?\n\n1?????? App\n2?????? System\n3?????? Theme\n\nPlease choose a number or type the name.",
        "wait_for_response": true
      }
    },
    {
      "id": "show_apps",
      "type": "function",
      "label": "Show Apps",
      "position": { "x": 300, "y": 300 },
      "data": {
        "function": "show_libraries",
        "parameters": {
          "library_type": "templates",
          "limit": 10
        },
        "message_ar": "???????? ?????????? ???????????????????? ??????????????:\n\n{library_items}\n\n???????? ???????????? ?????????? ???? ?????????? ????????.",
        "message_en": "Here are the available apps:\n\n{library_items}\n\nPlease choose an app or type its name.",
        "wait_for_response": true
      }
    },
    {
      "id": "show_systems",
      "type": "function",
      "label": "Show Systems",
      "position": { "x": 300, "y": 400 },
      "data": {
        "function": "show_libraries",
        "parameters": {
          "library_type": "systems",
          "limit": 10
        },
        "message_ar": "???????? ?????????? ???????????????? ??????????????:\n\n{library_items}\n\n???????? ???????????? ???????? ???? ?????????? ????????.",
        "message_en": "Here are the available systems:\n\n{library_items}\n\nPlease choose a system or type its name.",
        "wait_for_response": true
      }
    },
    {
      "id": "show_themes",
      "type": "function",
      "label": "Show Themes",
      "position": { "x": 300, "y": 500 },
      "data": {
        "function": "show_libraries",
        "parameters": {
          "library_type": "themes",
          "limit": 10
        },
        "message_ar": "???????? ?????????? ???????????????? ??????????????:\n\n{library_items}\n\n???????? ???????????? ?????? ???? ?????????? ????????.",
        "message_en": "Here are the available themes:\n\n{library_items}\n\nPlease choose a theme or type its name.",
        "wait_for_response": true
      }
    },
    {
      "id": "confirm_selection",
      "type": "message",
      "label": "Confirm Selection",
      "position": { "x": 100, "y": 500 },
      "data": {
        "message_ar": "????????! ?????????? {item_name}.\n\n???? ???????? ??????????????????",
        "message_en": "Great! You selected {item_name}.\n\nDo you want to continue?",
        "wait_for_response": true
      }
    },
    {
      "id": "ask_logo",
      "type": "message",
      "label": "Ask Logo",
      "position": { "x": 100, "y": 600 },
      "data": {
        "message_ar": "???? ???????? ???????? ????????????????\n\n??? ?????? - ???????? ???????? ???? ???????? ??????????????\n??? ???? - ?????????????? ???????? ??????????????\n\n???????? ?????????????? ???????? ???? ????.",
        "message_en": "Do you have a logo for the project?\n\n??? Yes - please upload it in the chat page\n??? No - we'll use a default logo\n\nPlease answer yes or no.",
        "wait_for_response": true
      }
    },
    {
      "id": "collect_info",
      "type": "function",
      "label": "Collect Info",
      "position": { "x": 100, "y": 700 },
      "data": {
        "function": "collect_customer_info",
        "questions": [
          {
            "field": "app_name",
            "question_ar": "???? ?????? ??????????????/??????????????",
            "question_en": "What is the app/system name?",
            "required": true
          },
          {
            "field": "color",
            "question_ar": "???? ???? ?????????? ???????????? ?????????? (??????????????)",
            "question_en": "What is your preferred color? (optional)",
            "required": false
          },
          {
            "field": "email",
            "question_ar": "???? ???? ?????????? ??????????????????????",
            "question_en": "What is your email?",
            "required": true,
            "validation": "email"
          },
          {
            "field": "phone",
            "question_ar": "???? ???? ?????? ????????????",
            "question_en": "What is your phone number?",
            "required": true,
            "validation": "phone"
          }
        ],
        "message_ar": "?????????? ???????? ?????????? ?????????????????? ??????????????:\n\n{current_question}",
        "message_en": "Now, please provide the following information:\n\n{current_question}",
        "wait_for_response": true
      }
    },
    {
      "id": "ask_payment",
      "type": "message",
      "label": "Ask Payment",
      "position": { "x": 100, "y": 800 },
      "data": {
        "message_ar": "??????????! ???? ?????? ???????? ??????????????????.\n\n???? ???????? ???????????? ???????? ???? ?????? ?????????????? ?????????????? ??????????????????\n\n???? ???????? - ?????????? ????????????\n??? ???????????? - ?????????? ?????? ????????????????\n\n???????? ???????????? ????????????.",
        "message_en": "Excellent! All information collected.\n\nDo you want to pay now or at the second visit for preview?\n\n???? Now - Immediate payment\n??? Later - Payment at preview\n\nPlease choose an option.",
        "wait_for_response": true
      }
    },
    {
      "id": "process_payment_now",
      "type": "function",
      "label": "Process Payment Now",
      "position": { "x": 300, "y": 800 },
      "data": {
        "function": "create_payment_session",
        "parameters": {
          "payment_method": "stripe"
        },
        "message_ar": "???????? ?????? ???????? ?????????? ????????. ???????? ?????????? ??????????.",
        "message_en": "Payment page will open now. Please complete the payment.",
        "wait_for_confirmation": true
      }
    },
    {
      "id": "submit_request",
      "type": "function",
      "label": "Submit Request",
      "position": { "x": 100, "y": 900 },
      "data": {
        "function": "submit_build_request",
        "message_ar": "???? ?????????? ???????? ??????????! ???????? ?????????????? ???????????? ?????????????? ????????????.",
        "message_en": "Your request has been submitted successfully! It will be reviewed and building will start soon.",
        "next_node": "notify_building"
      }
    },
    {
      "id": "notify_building",
      "type": "message",
      "label": "Notify Building",
      "position": { "x": 100, "y": 1000 },
      "data": {
        "message_ar": "???? ???? ?????? ????????????! ???????? ???????????? ?????? ????????????????.",
        "message_en": "???? Building started! You'll be notified when complete.",
        "wait_for_event": "build_complete"
      }
    },
    {
      "id": "notify_preview",
      "type": "function",
      "label": "Notify Preview",
      "position": { "x": 100, "y": 1100 },
      "data": {
        "function": "get_build_status",
        "message_ar": "??? ???????????? ??????????!\n\n???????? ????????????????: {preview_link}\n\n???????? ???????????? ?????????????? ???????????????? ??????????.",
        "message_en": "??? Build complete!\n\nPreview link: {preview_link}\n\nPlease review the project and let us know your feedback.",
        "wait_for_response": true
      }
    },
    {
      "id": "ask_revision",
      "type": "message",
      "label": "Ask Revision",
      "position": { "x": 100, "y": 1200 },
      "data": {
        "message_ar": "???? ???????? ???? ?????????? ????????????\n\n??? ?????? - ???????? ??????????????????\n??? ???? - ???????????????? ?????????? ??????????????\n\n???????? ??????????????.",
        "message_en": "Do you have any revision requests?\n\n??? Yes - mention revisions\n??? No - proceed to final payment\n\nPlease answer.",
        "wait_for_response": true
      }
    },
    {
      "id": "process_revision",
      "type": "function",
      "label": "Process Revision",
      "position": { "x": 300, "y": 1200 },
      "data": {
        "function": "submit_revision",
        "message_ar": "???? ?????????? ?????????? ??????????????. ???????? ?????????????? ???????????? ???????? ???????????? ????????.",
        "message_en": "Revision requests recorded. They will be applied and a new preview link will be sent.",
        "wait_for_event": "revision_complete"
      }
    },
    {
      "id": "request_final_payment",
      "type": "function",
      "label": "Request Final Payment",
      "position": { "x": 100, "y": 1300 },
      "data": {
        "function": "create_payment_session",
        "parameters": {
          "payment_method": "stripe"
        },
        "message_ar": "???????? ?????????? ?????????? ?????????????? ?????????????? ??????????.",
        "message_en": "Please complete final payment to receive the file.",
        "wait_for_confirmation": true
      }
    },
    {
      "id": "deliver_file",
      "type": "function",
      "label": "Deliver File",
      "position": { "x": 100, "y": 1400 },
      "data": {
        "function": "get_build_status",
        "message_ar": "??? ?????????? ???????? ??????????????!\n\n???????? ??????????????: {download_link}\n\n?????????? ???????????????? RARE 4N! ????",
        "message_en": "??? File ready for download!\n\nDownload link: {download_link}\n\nThank you for using RARE 4N! ????",
        "next_node": "end"
      }
    },
    {
      "id": "check_order",
      "type": "function",
      "label": "Check Order",
      "position": { "x": 500, "y": 300 },
      "data": {
        "function": "get_build_status",
        "message_ar": "???????? ????????:\n\n{status_info}\n\n???? ?????????? ???????????? ??????????",
        "message_en": "Your order status:\n\n{status_info}\n\nDo you need any other help?",
        "wait_for_response": true
      }
    },
    {
      "id": "transfer_human",
      "type": "transfer",
      "label": "Transfer",
      "position": { "x": 100, "y": 1500 },
      "data": {
        "phone_number": "+971529211077",
        "message_ar": "???????? ???????????? ?????? ???????? ?????????? ????????.",
        "message_en": "You will be transferred to our support team now."
      }
    },
    {
      "id": "end",
      "type": "end",
      "label": "End",
      "position": { "x": 100, "y": 1600 },
      "data": {
        "message_ar": "?????????? ???????????????? RARE 4N! ????",
        "message_en": "Thank you for using RARE 4N! ????"
      }
    }
  ],
  "edges": [
    { "from": "start", "to": "rare_greeting" },
    { "from": "rare_greeting", "to": "detect_intent" },
    { "from": "detect_intent", "to": "show_apps", "condition": "app" },
    { "from": "detect_intent", "to": "show_systems", "condition": "system" },
    { "from": "detect_intent", "to": "show_themes", "condition": "theme" },
    { "from": "detect_intent", "to": "check_order", "condition": "order" },
    { "from": "detect_intent", "to": "ask_type", "condition": "default" },
    { "from": "ask_type", "to": "show_apps", "condition": "app" },
    { "from": "ask_type", "to": "show_systems", "condition": "system" },
    { "from": "ask_type", "to": "show_themes", "condition": "theme" },
    { "from": "show_apps", "to": "confirm_selection" },
    { "from": "show_systems", "to": "confirm_selection" },
    { "from": "show_themes", "to": "confirm_selection" },
    { "from": "confirm_selection", "to": "ask_logo" },
    { "from": "ask_logo", "to": "collect_info" },
    { "from": "collect_info", "to": "ask_payment" },
    { "from": "ask_payment", "to": "process_payment_now", "condition": "now" },
    { "from": "ask_payment", "to": "submit_request", "condition": "later" },
    { "from": "process_payment_now", "to": "submit_request" },
    { "from": "submit_request", "to": "notify_building" },
    { "from": "notify_building", "to": "notify_preview" },
    { "from": "notify_preview", "to": "ask_revision" },
    { "from": "ask_revision", "to": "process_revision", "condition": "yes" },
    { "from": "ask_revision", "to": "request_final_payment", "condition": "no" },
    { "from": "process_revision", "to": "notify_preview" },
    { "from": "request_final_payment", "to": "deliver_file" },
    { "from": "deliver_file", "to": "end" },
    { "from": "check_order", "to": "transfer_human", "condition": "need_help" },
    { "from": "check_order", "to": "end", "condition": "no_help" }
  ]
}



