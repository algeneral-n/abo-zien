{
  "name": "RARE 4N Widget Workflow",
  "version": "1.0.0",
  "description": "???????? ?????? ?????????? ?????????????? ???? ElevenLabs - ?????????? ???????????? ?????? ???????????? ???????? ???????????????? ???????????? ???????????? ????????????????",
  "agent_id": "agent_0701kc4axybpf6fvak70xwfzpyka",
  "system_agent_id": "9401kb2n0gf5e2wtp4sfs8chdmk1",
  "workflow": {
    "initial_state": "welcome",
    "states": {
      "welcome": {
        "name": "??????????????",
        "description": "?????????? ?????????????? ???????????? RARE",
        "actions": [
          {
            "type": "greet",
            "message": "????????????! ?????? RARE?? ???????????? ??????????. ???????????? ?????????????? ???? ???????? ???????????? ???? ??????????. ?????? ???????????? ?????????????? ????????????"
          },
          {
            "type": "show_capabilities",
            "capabilities": [
              "???????????? ?????????????????? ???????????????? ????????????????",
              "?????? ???????????????? ????????????????????",
              "?????????? ?????????? ??????????",
              "?????????????? ???????????????? ?????????????????????? ???????????????? ????????????????",
              "???????????? ?????? ???????? ????????????"
            ]
          }
        ],
        "transitions": [
          {
            "condition": "user_asks_about_apps",
            "next_state": "show_apps"
          },
          {
            "condition": "user_asks_about_systems",
            "next_state": "show_systems"
          },
          {
            "condition": "user_asks_about_themes",
            "next_state": "show_themes"
          },
          {
            "condition": "user_asks_about_payment",
            "next_state": "explain_payment"
          },
          {
            "condition": "user_has_request",
            "next_state": "understand_request"
          }
        ]
      },
      "understand_request": {
        "name": "?????? ??????????",
        "description": "?????? ?????? ???????????? ???????????? ?????????? ??????????????",
        "actions": [
          {
            "type": "listen",
            "voice_recognition": true,
            "dialect_detection": true,
            "language_detection": true
          },
          {
            "type": "ask_clarifying_questions",
            "questions": [
              "???? ?????? ??????????????/???????????? ???????? ????????????",
              "???? ???????? ?????????????? ????????????",
              "???? ???? ?????????? ???? ??????????????/??????????????"
            ]
          }
        ],
        "transitions": [
          {
            "condition": "request_type_app",
            "next_state": "show_apps"
          },
          {
            "condition": "request_type_system",
            "next_state": "show_systems"
          },
          {
            "condition": "request_type_theme",
            "next_state": "show_themes"
          },
          {
            "condition": "request_unclear",
            "next_state": "understand_request",
            "action": "ask_for_clarification"
          }
        ]
      },
      "show_apps": {
        "name": "?????? ??????????????????",
        "description": "?????? ?????????? ?????????????????? ??????????????",
        "actions": [
          {
            "type": "show_library",
            "library_type": "templates",
            "categories": [
              "Social Media",
              "E-commerce",
              "Productivity",
              "Communication",
              "Entertainment",
              "Health & Fitness",
              "Education",
              "Finance",
              "Travel",
              "Food & Restaurant"
            ]
          },
          {
            "type": "explain_features",
            "features": [
              "????????????????",
              "??????????????",
              "??????????????",
              "??????????????????????"
            ]
          }
        ],
        "transitions": [
          {
            "condition": "user_selects_app",
            "next_state": "preview_selected"
          },
          {
            "condition": "user_asks_questions",
            "next_state": "answer_questions"
          },
          {
            "condition": "user_wants_different_category",
            "next_state": "show_apps"
          }
        ]
      },
      "show_systems": {
        "name": "?????? ??????????????",
        "description": "?????? ?????????????? ??????????????",
        "actions": [
          {
            "type": "show_library",
            "library_type": "systems",
            "categories": [
              "Business Systems",
              "Social Media Systems",
              "Communication Systems",
              "Productivity Systems",
              "Storage Systems",
              "Security Systems",
              "Payment Systems",
              "Analytics Systems"
            ]
          },
          {
            "type": "explain_features",
            "features": [
              "??????????????",
              "????????????????",
              "????????????????????",
              "??????????????????????"
            ]
          }
        ],
        "transitions": [
          {
            "condition": "user_selects_system",
            "next_state": "preview_selected"
          },
          {
            "condition": "user_asks_questions",
            "next_state": "answer_questions"
          },
          {
            "condition": "user_wants_different_category",
            "next_state": "show_systems"
          }
        ]
      },
      "show_themes": {
        "name": "?????? ??????????????",
        "description": "?????? ?????????????? ??????????????",
        "actions": [
          {
            "type": "show_library",
            "library_type": "themes",
            "categories": [
              "Cyber & Neon",
              "Glass & Modern",
              "Gold & Luxury",
              "Nature",
              "Professional",
              "Vibrant",
              "Monochrome",
              "Gradient"
            ]
          },
          {
            "type": "explain_design",
            "design_elements": [
              "?????????????? ????????????????",
              "?????????????? ????????????????",
              "?????????? ??????????????",
              "?????????????? ??????????"
            ]
          }
        ],
        "transitions": [
          {
            "condition": "user_selects_theme",
            "next_state": "preview_selected"
          },
          {
            "condition": "user_asks_questions",
            "next_state": "answer_questions"
          },
          {
            "condition": "user_wants_different_category",
            "next_state": "show_themes"
          }
        ]
      },
      "preview_selected": {
        "name": "???????????? ??????????????",
        "description": "?????? ???????????? ???????????? ??????????????",
        "actions": [
          {
            "type": "show_preview",
            "preview_type": "detailed",
            "includes": [
              "??????????",
              "??????????",
              "????????????????",
              "??????????????",
              "?????????????? (??????????????)",
              "?????????????? (??????????????????)",
              "???????????????? (??????????????)"
            ]
          },
          {
            "type": "ask_for_modifications",
            "question": "???? ???????? ???? ?????????????? ???? ????????????????"
          }
        ],
        "transitions": [
          {
            "condition": "user_approves",
            "next_state": "collect_info"
          },
          {
            "condition": "user_wants_modifications",
            "next_state": "handle_modifications"
          },
          {
            "condition": "user_wants_different_item",
            "next_state": "understand_request"
          }
        ]
      },
      "collect_info": {
        "name": "?????? ??????????????????",
        "description": "?????? ?????????????????? ???????????????? ????????????",
        "actions": [
          {
            "type": "collect",
            "fields": [
              {
                "name": "app_name",
                "label": "?????? ??????????????/????????????",
                "required": true,
                "validation": "non_empty"
              },
              {
                "name": "email",
                "label": "???????????? ????????????????????",
                "required": true,
                "validation": "email"
              },
              {
                "name": "phone",
                "label": "?????? ????????????",
                "required": true,
                "validation": "phone"
              },
              {
                "name": "color",
                "label": "?????????? ????????????",
                "required": false,
                "validation": "color"
              },
              {
                "name": "logo",
                "label": "????????????",
                "required": false,
                "validation": "file",
                "file_types": ["image/png", "image/jpeg", "image/svg+xml"]
              }
            ]
          }
        ],
        "transitions": [
          {
            "condition": "all_info_collected",
            "next_state": "payment_question"
          },
          {
            "condition": "info_missing",
            "next_state": "collect_info",
            "action": "ask_for_missing_info"
          }
        ]
      },
      "payment_question": {
        "name": "???????? ??????????",
        "description": "???????? ???????????? ???? ?????????? ??????????",
        "actions": [
          {
            "type": "ask_payment_method",
            "options": [
              {
                "value": "now",
                "label": "?????????? ????????",
                "description": "???????? ???????????? ?????????? ?????? ??????????"
              },
              {
                "value": "later",
                "label": "?????????? ????????????",
                "description": "?????????? ?????? ???????????????? (?????????????? ??????????????)"
              }
            ]
          }
        ],
        "transitions": [
          {
            "condition": "user_chooses_pay_now",
            "next_state": "create_payment_session"
          },
          {
            "condition": "user_chooses_pay_later",
            "next_state": "submit_request"
          },
          {
            "condition": "user_asks_about_payment",
            "next_state": "explain_payment"
          }
        ]
      },
      "explain_payment": {
        "name": "?????? ??????????",
        "description": "?????? ???????? ?????????? ????????????",
        "actions": [
          {
            "type": "explain",
            "topics": [
              "?????? ?????????? ?????????????? (Stripe, Apple Pay, Google Pay)",
              "???????????? ??????????????????",
              "??????????????????",
              "??????????????"
            ]
          }
        ],
        "transitions": [
          {
            "condition": "user_understands",
            "next_state": "payment_question"
          },
          {
            "condition": "user_has_more_questions",
            "next_state": "explain_payment"
          }
        ]
      },
      "create_payment_session": {
        "name": "?????????? ???????? ??????????",
        "description": "?????????? ???????? Stripe Checkout",
        "actions": [
          {
            "type": "call_tool",
            "tool_name": "create_checkout_session",
            "parameters": {
              "amount": "calculated",
              "currency": "SAR",
              "metadata": {
                "client_id": "from_context",
                "request_id": "from_context",
                "item_type": "from_context",
                "item_id": "from_context"
              }
            }
          },
          {
            "type": "redirect",
            "url": "payment_session_url"
          }
        ],
        "transitions": [
          {
            "condition": "payment_successful",
            "next_state": "start_building"
          },
          {
            "condition": "payment_failed",
            "next_state": "payment_error"
          },
          {
            "condition": "payment_cancelled",
            "next_state": "payment_question"
          }
        ]
      },
      "submit_request": {
        "name": "?????????? ??????????",
        "description": "?????????? ?????????? ????????????????",
        "actions": [
          {
            "type": "call_tool",
            "tool_name": "submit_request",
            "parameters": {
              "client_id": "from_context",
              "request_data": "from_context"
            }
          },
          {
            "type": "notify",
            "message": "???? ?????????? ???????? ??????????. ???????? ?????????????? ???????????? ?????????????? ????????????."
          }
        ],
        "transitions": [
          {
            "condition": "request_submitted",
            "next_state": "waiting_approval"
          },
          {
            "condition": "request_failed",
            "next_state": "error_handling"
          }
        ]
      },
      "start_building": {
        "name": "?????? ????????????",
        "description": "?????? ???????? ??????????????/????????????",
        "actions": [
          {
            "type": "call_tool",
            "tool_name": "start_build",
            "parameters": {
              "request_id": "from_context",
              "platforms": ["ios", "android", "web", "hybrid"]
            }
          },
          {
            "type": "notify",
            "message": "???? ?????? ???????? ????????????/??????????. ???????? ?????????? ?????????????????? ????????????."
          }
        ],
        "transitions": [
          {
            "condition": "build_started",
            "next_state": "building_in_progress"
          },
          {
            "condition": "build_failed",
            "next_state": "error_handling"
          }
        ]
      },
      "building_in_progress": {
        "name": "???????????? ?????? ??????????????",
        "description": "???????????? ?????????? ????????????",
        "actions": [
          {
            "type": "update_status",
            "status_updates": [
              "???????? ????????????...",
              "???????? ?????????? ??????????????...",
              "???????? ??????????????...",
              "???????? ??????????..."
            ]
          }
        ],
        "transitions": [
          {
            "condition": "build_completed",
            "next_state": "delivery"
          },
          {
            "condition": "build_failed",
            "next_state": "error_handling"
          }
        ]
      },
      "delivery": {
        "name": "??????????????",
        "description": "?????????? ??????????????/???????????? ????????????",
        "actions": [
          {
            "type": "call_tool",
            "tool_name": "send_build_files",
            "parameters": {
              "client_email": "from_context",
              "build_files": "from_build",
              "download_link": "from_build"
            }
          },
          {
            "type": "notify",
            "message": "???? ???????????????? ???? ???????? ????????????/??????????! ???? ?????????? ?????????????? ?????? ?????????? ????????????????????."
          }
        ],
        "transitions": [
          {
            "condition": "delivery_completed",
            "next_state": "completed"
          },
          {
            "condition": "delivery_failed",
            "next_state": "error_handling"
          }
        ]
      },
      "answer_questions": {
        "name": "?????????????? ?????? ??????????????",
        "description": "?????????????? ?????? ?????????? ????????????",
        "actions": [
          {
            "type": "answer",
            "sources": [
              "library_info",
              "system_prompt",
              "conversation_history"
            ]
          }
        ],
        "transitions": [
          {
            "condition": "question_answered",
            "next_state": "previous_state"
          },
          {
            "condition": "user_has_more_questions",
            "next_state": "answer_questions"
          }
        ]
      },
      "handle_modifications": {
        "name": "???????????? ??????????????????",
        "description": "???????????? ?????????? ?????????????? ???? ????????????",
        "actions": [
          {
            "type": "collect_modifications",
            "modification_types": [
              "?????????? ??????????????",
              "?????????? ??????????????",
              "?????????? ??????????",
              "?????????? ??????????????"
            ]
          }
        ],
        "transitions": [
          {
            "condition": "modifications_collected",
            "next_state": "preview_selected"
          },
          {
            "condition": "user_cancels",
            "next_state": "preview_selected"
          }
        ]
      },
      "waiting_approval": {
        "name": "???????????? ????????????????",
        "description": "???????????? ???????????? ?????? ??????????",
        "actions": [
          {
            "type": "notify",
            "message": "???????? ?????? ????????????????. ???????? ???????????? ?????? ????????????????."
          }
        ],
        "transitions": [
          {
            "condition": "approved",
            "next_state": "start_building"
          },
          {
            "condition": "rejected",
            "next_state": "request_rejected"
          }
        ]
      },
      "error_handling": {
        "name": "???????????? ??????????????",
        "description": "???????????? ?????????????? ????????????????????????",
        "actions": [
          {
            "type": "handle_error",
            "error_types": [
              "payment_error",
              "build_error",
              "delivery_error",
              "network_error"
            ]
          },
          {
            "type": "notify",
            "message": "?????? ??????. ???????? ???????????????? ?????? ???????? ???? ?????????????? ????????."
          }
        ],
        "transitions": [
          {
            "condition": "error_resolved",
            "next_state": "previous_state"
          },
          {
            "condition": "error_critical",
            "next_state": "contact_support"
          }
        ]
      },
      "contact_support": {
        "name": "?????????????? ???? ??????????",
        "description": "?????????????? ???? ???????? ??????????",
        "actions": [
          {
            "type": "provide_contact",
            "contact_info": {
              "email": "GM@ZIEN-AI.APP",
              "phone": "+971529211077",
              "website": "https://zien-ai.app"
            }
          }
        ],
        "transitions": [
          {
            "condition": "user_understands",
            "next_state": "welcome"
          }
        ]
      },
      "completed": {
        "name": "??????????",
        "description": "???????????? ?????????????? ??????????",
        "actions": [
          {
            "type": "thank",
            "message": "?????????? ???????????????? RARE 4N! ?????????? ???? ???????? ????????????/?????????? ???????????? ????."
          },
          {
            "type": "offer_help",
            "message": "?????? ?????????? ???? ???????????? ?????????????? ?????? ?????? ????????????!"
          }
        ],
        "transitions": [
          {
            "condition": "user_has_new_request",
            "next_state": "welcome"
          }
        ]
      }
    }
  },
  "voice_settings": {
    "recognition": {
      "enabled": true,
      "language": "auto",
      "dialect_detection": true,
      "confidence_threshold": 0.7
    },
    "synthesis": {
      "enabled": true,
      "voice_id": "9401kb2n0gf5e2wtp4sfs8chdmk1",
      "model": "eleven_multilingual_v2",
      "stability": 0.5,
      "similarity_boost": 0.75,
      "style": 0.0,
      "use_speaker_boost": true
    }
  },
  "dialect_support": {
    "arabic": [
      "msa",
      "egyptian",
      "gulf",
      "levantine",
      "maghrebi",
      "sudanese",
      "yemeni",
      "iraqi"
    ],
    "english": [
      "british",
      "american",
      "australian"
    ]
  },
  "tools": [
    {
      "name": "create_checkout_session",
      "description": "?????????? ???????? Stripe Checkout ??????????",
      "parameters": {
        "amount": "number",
        "currency": "string",
        "metadata": "object"
      }
    },
    {
      "name": "submit_request",
      "description": "?????????? ?????? ???????????? ????????????????",
      "parameters": {
        "client_id": "string",
        "request_data": "object"
      }
    },
    {
      "name": "start_build",
      "description": "?????? ???????? ??????????????/????????????",
      "parameters": {
        "request_id": "string",
        "platforms": "array"
      }
    },
    {
      "name": "send_build_files",
      "description": "?????????? ?????????? ???????????? ????????????",
      "parameters": {
        "client_email": "string",
        "build_files": "array",
        "download_link": "string"
      }
    }
  ]
}


